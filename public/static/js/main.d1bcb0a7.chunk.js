(this["webpackJsonp08.calendar"]=this["webpackJsonp08.calendar"]||[]).push([[0],{123:function(e,t,n){},127:function(e,t,n){},128:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(11),s=n.n(c),o=n(12),i=n(32),u=n(79),l=n(8),j="[AUTH] FINISH CHECKING LOGIN STATE",d="[AUTH] LOGIN",b="[AUTH] LOGOUT",f={checking:!0},p=n(69),m="[CALENDAR] ADD NEW",O="[CALENDAR] SET ACTIVE",h="[CALENDAR] CLEAR ACTIVE",v="[CALENDAR] UPDATE",x="[CALENDAR] DELETE",g="[CALENDAR] LOAD",y="[CALENDAR] CLEAR LOGOUT",E={events:[],activeEvent:null},N="[UI] OPEN MODAL",w="[UI] CLOSE MODAL",k={modalOpen:!1},C=Object(i.b)({ui:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:k,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case N:return Object(l.a)(Object(l.a)({},e),{},{openModal:!0});case w:return Object(l.a)(Object(l.a)({},e),{},{openModal:!1});default:return e}},calendar:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:E,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case m:return Object(l.a)(Object(l.a)({},e),{},{events:[].concat(Object(p.a)(e.events),[t.payload])});case O:return Object(l.a)(Object(l.a)({},e),{},{activeEvent:t.payload});case h:return Object(l.a)(Object(l.a)({},e),{},{activeEvent:null});case v:return Object(l.a)(Object(l.a)({},e),{},{events:e.events.map((function(e){return e.id===t.payload.id?t.payload:e}))});case x:return Object(l.a)(Object(l.a)({},e),{},{events:e.events.filter((function(t){return t.id!==e.activeEvent.id})),activeEvent:null});case g:return Object(l.a)(Object(l.a)({},e),{},{events:Object(p.a)(t.payload)});case y:return Object(l.a)({},E);default:return e}},auth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case d:return Object(l.a)(Object(l.a)(Object(l.a)({},e),t.payload),{},{checking:!1});case j:return Object(l.a)(Object(l.a)({},e),{},{checking:!1});case b:return{checking:!1};default:return e}}}),A="undefined"!==typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||i.c,S=Object(i.d)(C,A(Object(i.a)(u.a))),T=n(40),D=n(13),I=n(16),L=n.n(I),R=n(41),P=n(52),G=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object(r.useState)(e),n=Object(P.a)(t,2),a=n[0],c=n[1],s=function(){c(e)},o=function(e){c(e)},i=function(e){var t=e.target,n=t.name,r=t.value;c((function(e){return Object(l.a)(Object(l.a)({},e),{},Object(R.a)({},n,r))}))};return{values:a,handleInputChange:i,reset:s,setNewValues:o}},U=n(14),_=n.n(U),M=n(19),H="https://calendarappmern.herokuapp.com/api",V=function(){var e=Object(M.a)(_.a.mark((function e(t,n){var r,a,c=arguments;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=c.length>2&&void 0!==c[2]?c[2]:"GET",a="".concat(H,"/").concat(t),"GET"!==r){e.next=6;break}return e.abrupt("return",fetch(a));case 6:return e.abrupt("return",fetch(a,{method:r,headers:{"Content-Type":"application/json"},body:JSON.stringify(n)}));case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),F=function(){var e=Object(M.a)(_.a.mark((function e(t,n){var r,a,c,s=arguments;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=s.length>2&&void 0!==s[2]?s[2]:"GET",a="".concat(H,"/").concat(t),c=localStorage.getItem("token")||"","GET"!==r){e.next=7;break}return e.abrupt("return",fetch(a,{method:r,headers:{"x-token":c}}));case 7:return e.abrupt("return",fetch(a,{method:r,headers:{"Content-Type":"application/json","x-token":c},body:JSON.stringify(n)}));case 8:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),J=n(136),z=function(e){return e.map((function(e){return Object(l.a)(Object(l.a)({},e),{},{end:Object(J.a)(e.end),start:Object(J.a)(e.start)})}))},B=function(e){return{type:m,payload:e}},W=function(){return{type:h}},X=function(e){return{type:v,payload:e}},q=function(){return{type:x}},K=function(e){return{type:g,payload:e}},Q=function(e){return{type:d,payload:e}},Y=function(){return{type:j}},Z=function(){return function(e){localStorage.clear(),e($()),e({type:y})}},$=function(){return{type:b}},ee=(n(92),n(2)),te=function(){var e=Object(o.b)(),t=G({lEmail:"andres@gmail.com",lPassword:"123456"}),n=t.values,r=t.handleInputChange,a=G({rName:"",rEmail:"",rPassword:"",rPassword2:""}),c=a.values,s=a.handleInputChange,i=n.lEmail,u=n.lPassword,l=c.rName,j=c.rEmail,d=c.rPassword,b=c.rPassword2;return Object(ee.jsx)("div",{className:"container login-container",children:Object(ee.jsxs)("div",{className:"row",children:[Object(ee.jsxs)("div",{className:"col-md-6 login-form-1",children:[Object(ee.jsx)("h3",{children:"Ingreso"}),Object(ee.jsxs)("form",{onSubmit:function(t){var n,r;t.preventDefault(),i&&u?e((n=i,r=u,function(){var e=Object(M.a)(_.a.mark((function e(t){var a,c;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V("auth",{email:n,password:r},"POST");case 2:return a=e.sent,e.next=5,a.json();case 5:(c=e.sent).success?(localStorage.setItem("token",c.token),localStorage.setItem("token-init-date",(new Date).getTime()),t(Q({uid:c.uid,name:c.name}))):L.a.fire("Error",c.error,"error");case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())):L.a.fire("Rellene los datos","Debe introducir un email v\xe1lido y su correspondiente contrase\xf1a","error")},children:[Object(ee.jsx)("div",{className:"form-group",children:Object(ee.jsx)("input",{type:"text",className:"form-control",placeholder:"Correo",name:"lEmail",value:i,onChange:r})}),Object(ee.jsx)("div",{className:"form-group",children:Object(ee.jsx)("input",{type:"password",className:"form-control",placeholder:"Contrase\xf1a",name:"lPassword",value:u,onChange:r})}),Object(ee.jsx)("div",{className:"form-group",children:Object(ee.jsx)("input",{type:"submit",className:"btnSubmit",value:"Login"})})]})]}),Object(ee.jsxs)("div",{className:"col-md-6 login-form-2",children:[Object(ee.jsx)("h3",{children:"Registro"}),Object(ee.jsxs)("form",{onSubmit:function(t){return t.preventDefault(),l&&j&&d&&b?d!==b?L.a.fire("Error","Las contrase\xf1as deben coincidir.","error"):void e((n={name:l,email:j,password:d},function(){var e=Object(M.a)(_.a.mark((function e(t){var r,a;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V("auth/new",n,"POST");case 2:return r=e.sent,e.next=5,r.json();case 5:(a=e.sent).success?(localStorage.setItem("token",a.token),localStorage.setItem("token-init-date",(new Date).getTime()),t(Q({uid:a.uid,name:a.name}))):L.a.fire("Error",a.error,"error");case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())):L.a.fire("Error","Debes rellenar todos los campos","error");var n},children:[Object(ee.jsx)("div",{className:"form-group",children:Object(ee.jsx)("input",{type:"text",className:"form-control",placeholder:"Nombre",name:"rName",onChange:s,value:l})}),Object(ee.jsx)("div",{className:"form-group",children:Object(ee.jsx)("input",{type:"email",className:"form-control",placeholder:"Correo",name:"rEmail",onChange:s,value:j})}),Object(ee.jsx)("div",{className:"form-group",children:Object(ee.jsx)("input",{type:"password",className:"form-control",placeholder:"Contrase\xf1a",name:"rPassword",value:d,onChange:s})}),Object(ee.jsx)("div",{className:"form-group",children:Object(ee.jsx)("input",{type:"password",className:"form-control",placeholder:"Repita la contrase\xf1a",name:"rPassword2",value:b,onChange:s})}),Object(ee.jsx)("div",{className:"form-group",children:Object(ee.jsx)("input",{type:"submit",className:"btnSubmit",value:"Crear cuenta"})})]})]})]})})},ne=n(68),re=n(146),ae=n(144),ce=n(142),se=n(143),oe=n(145),ie=function(){var e=Object(o.b)(),t=Object(o.c)((function(e){return e.auth})).name;return Object(ee.jsxs)("div",{className:"navbar navbar-dark bg-dark mb-4",children:[Object(ee.jsx)("span",{className:"navbar-brand",children:t}),Object(ee.jsxs)("button",{onClick:function(){e(Z())},className:"btn btn-outline-danger",children:[Object(ee.jsx)("i",{className:"fas fa-sign-out-alt"}),Object(ee.jsx)("span",{children:" Salir"})]})]})},ue=(n(94),{allDay:"Todo el d\xeda",previous:"<",next:">",today:"Hoy",month:"Mes",week:"Semana",day:"D\xeda",agenda:"Agenda",date:"Fecha",time:"Hora",event:"Evento",noEventsInRange:"No hay eventos en este rango",showMore:function(e){return"+ Ver m\xe1s (".concat(e,")")}}),le=function(e){var t=e.event,n=t.title,r=t.user;return Object(ee.jsxs)("div",{children:[Object(ee.jsx)("span",{children:n}),Object(ee.jsx)("br",{}),Object(ee.jsxs)("small",{children:["- ",r.name]})]})},je=n(63),de=n.n(je),be=n(64),fe=n.n(be),pe=n(137),me=n(138),Oe=n(139),he=n(140),ve=n(141),xe=function(){return{type:N}},ge=(n(123),{content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)"}});de.a.setAppElement("#root");var ye=Object(pe.a)(Object(me.a)(Object(Oe.a)(new Date,0),0),1),Ee=function(){var e=Object(o.c)((function(e){return e.ui})).openModal,t=Object(o.c)((function(e){return e.calendar})).activeEvent,n=Object(o.b)(),a=G({title:"",notes:"",start:ye,end:Object(pe.a)(ye,1)}),c=a.values,s=a.handleInputChange,i=a.reset,u=a.setNewValues,l=Object(r.useRef)(!1),j=c.notes,d=c.title,b=c.start,f=c.end;Object(r.useEffect)((function(){t&&!l.current&&(l.current=!0,u(t)),!t&&l.current&&(l.current=!1,i())}),[t,u,i]);var p=function(){l.current&&(l.current=!1),t&&n(W()),i(),n({type:w})};return Object(ee.jsxs)(de.a,{isOpen:e,onRequestClose:p,style:ge,contentLabel:"no se loco",className:"modal",overlayClassName:"modal-fondo",closeTimeoutMS:200,children:[Object(ee.jsx)("h1",{children:t?"Editar evento":"Nuevo evento"}),Object(ee.jsx)("hr",{}),Object(ee.jsxs)("form",{onSubmit:function(e){var r;e.preventDefault(),Object(he.a)(b,f)||Object(ve.a)(f,b)?L.a.fire("Aviso","La fecha fin debe ser mayor a la fecha de inicio.","warning"):d.trim()?(n(t?(r=c,function(){var e=Object(M.a)(_.a.mark((function e(t){var n,a;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,F("events/".concat(r.id),r,"PUT");case 3:return n=e.sent,e.next=6,n.json();case 6:(a=e.sent).success?t(X(r)):L.a.fire("Error",a.error,"error"),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),L.a.fire("Error",e.t0,"error");case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}()):function(e){var t=e.notes,n=e.title,r=e.start,a=e.end;return function(){var e=Object(M.a)(_.a.mark((function e(c,s){var o,i,u,l,j,d,b;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o={notes:t,title:n,start:new Date(r).getTime(),end:new Date(a).getTime()},i=s().auth,u=i.uid,l=i.name,e.prev=2,e.next=5,F("events",o,"POST");case 5:return j=e.sent,e.next=8,j.json();case 8:(d=e.sent).success&&(b={notes:t,title:n,end:a,start:r,id:d.event.id,user:{_id:u,name:l}},c(B(b))),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),L.a.fire("Error",e.t0,"error");case 15:case"end":return e.stop()}}),e,null,[[2,12]])})));return function(t,n){return e.apply(this,arguments)}}()}(c)),p()):L.a.fire("Aviso","El evento debe tener un t\xedtulo","warning")},className:"container",children:[Object(ee.jsxs)("div",{className:"form-group",children:[Object(ee.jsx)("label",{children:"Fecha y hora inicio"}),Object(ee.jsx)(fe.a,{className:"form-control",value:b,onChange:function(e){return s({target:{name:"start",value:e}})}})]}),Object(ee.jsxs)("div",{className:"form-group",children:[Object(ee.jsx)("label",{children:"Fecha y hora fin"}),Object(ee.jsx)(fe.a,{className:"form-control",minDate:b,value:f,onChange:function(e){return s({target:{name:"end",value:e}})}})]}),Object(ee.jsx)("hr",{}),Object(ee.jsxs)("div",{className:"form-group",children:[Object(ee.jsx)("label",{children:"Titulo y notas"}),Object(ee.jsx)("input",{type:"text",className:"form-control",placeholder:"T\xedtulo del evento",name:"title",autoComplete:"off",value:d,onChange:s}),Object(ee.jsx)("small",{id:"emailHelp",className:"form-text text-muted",children:"Una descripci\xf3n corta"})]}),Object(ee.jsxs)("div",{className:"form-group",children:[Object(ee.jsx)("textarea",{type:"text",className:"form-control",placeholder:"Notas",rows:"5",name:"notes",value:j,onChange:s,style:{resize:"none"}}),Object(ee.jsx)("small",{id:"emailHelp",className:"form-text text-muted",children:"Informaci\xf3n adicional"})]}),Object(ee.jsxs)("button",{type:"submit",className:"btn btn-outline-primary btn-block",children:[Object(ee.jsx)("i",{className:"far fa-save"}),Object(ee.jsx)("span",{children:" Guardar"})]})]})]})},Ne=function(){var e=Object(o.b)(),t=Object(o.c)((function(e){return e.calendar})).activeEvent;return Object(ee.jsx)("button",{onClick:function(){t&&e(W()),e(xe())},className:"btn btn-primary fab ",children:Object(ee.jsx)("i",{className:"fas fa-plus"})})},we=function(){var e=Object(o.b)();return Object(ee.jsxs)("button",{onClick:function(){e(function(){var e=Object(M.a)(_.a.mark((function e(t,n){var r,a,c;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n().calendar.activeEvent.id,e.prev=1,e.next=4,F("events/".concat(r),{},"DELETE");case 4:return a=e.sent,e.next=7,a.json();case 7:(c=e.sent).success?t(q()):L.a.fire("Error",c.error,"error"),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),L.a.fire("Error",e.t0,"error");case 14:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t,n){return e.apply(this,arguments)}}())},className:"btn btn-danger fab-danger",children:[Object(ee.jsx)("i",{className:"fas fa-trash"}),Object(ee.jsx)("span",{children:" Borrar Evento "})]})},ke={es:oe.a},Ce=Object(ne.b)({format:re.a,parse:ae.a,startOfWeek:ce.a,getDay:se.a,locales:ke}),Ae=function(){var e=Object(r.useState)(localStorage.getItem("lastView")||"month"),t=Object(P.a)(e,2),n=t[0],a=t[1],c=Object(o.b)(),s=Object(o.c)((function(e){return e.calendar})),i=s.events,u=s.activeEvent,l=Object(o.c)((function(e){return e.auth})).uid;Object(r.useEffect)((function(){c(function(){var e=Object(M.a)(_.a.mark((function e(t){var n,r,a;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,F("events");case 3:return n=e.sent,e.next=6,n.json();case 6:r=e.sent,a=z(r.events),r.success&&t(K(a)),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),L.a.fire("Error",e.t0,"error");case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t){return e.apply(this,arguments)}}())}),[c]);return Object(ee.jsxs)("div",{className:"calendar__container",children:[Object(ee.jsx)(ie,{}),Object(ee.jsx)(ne.a,{messages:ue,culture:"es",localizer:Ce,events:i,startAccessor:"start",endAccessor:"end",eventPropGetter:function(e,t,n,r){return{style:{backgroundColor:l===e.user._id?"red":"blue",borderRadius:"0px",opacity:.8,display:"block",color:"white"}}},components:{event:le},onDoubleClickEvent:function(e){c(xe())},onSelectEvent:function(e){c({type:O,payload:e})},onView:function(e){a(e),localStorage.setItem("lastView",e)},view:n,selectable:!0,onSelectSlot:function(e){u&&c(W())}}),Object(ee.jsx)(Ne,{}),u&&Object(ee.jsx)(we,{}),Object(ee.jsx)(Ee,{})]})},Se=n(50),Te=function(e){var t=e.isAuthenticated,n=e.children,r=Object(Se.a)(e,["isAuthenticated","children"]);return Object(ee.jsx)(D.b,Object(l.a)(Object(l.a)({},r),{},{children:t?n:Object(ee.jsx)(D.a,{to:"/login"})}))},De=function(e){var t=e.isAuthenticated,n=e.children,r=Object(Se.a)(e,["isAuthenticated","children"]);return Object(ee.jsx)(D.b,Object(l.a)(Object(l.a)({},r),{},{children:t?Object(ee.jsx)(D.a,{to:"/"}):n}))},Ie=function(){var e=Object(o.b)(),t=Object(o.c)((function(e){return e.auth})),n=t.checking,a=t.uid;return Object(r.useEffect)((function(){e(function(){var e=Object(M.a)(_.a.mark((function e(t){var n,r;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,F("auth/renew");case 2:return n=e.sent,e.next=5,n.json();case 5:(r=e.sent).success?(localStorage.setItem("token",r.token),localStorage.setItem("token-init-date",(new Date).getTime()),t(Q({uid:r.uid,name:r.name}))):t(Y());case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[e]),n?Object(ee.jsx)("h1",{children:"Cargando..."}):Object(ee.jsx)(T.a,{children:Object(ee.jsx)("div",{children:Object(ee.jsxs)(D.d,{children:[Object(ee.jsx)(De,{isAuthenticated:!!a,path:"/login",children:Object(ee.jsx)(te,{})}),Object(ee.jsx)(Te,{isAuthenticated:!!a,exact:!0,path:"/",children:Object(ee.jsx)(Ae,{})}),Object(ee.jsx)(D.a,{to:"/"})]})})})},Le=function(){return Object(ee.jsx)(o.a,{store:S,children:Object(ee.jsx)(Ie,{})})};n(127);s.a.render(Object(ee.jsx)(a.a.StrictMode,{children:Object(ee.jsx)(Le,{})}),document.getElementById("root"))},92:function(e,t,n){}},[[128,1,2]]]);
//# sourceMappingURL=main.d1bcb0a7.chunk.js.map